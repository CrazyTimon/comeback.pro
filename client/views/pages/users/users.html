<template name="users">
	{{#if currentUser}}
		{{#if user.profile.steamID}}
			<div class="container">
				<div class="page-header">
					<h1>
						ИГРОКИ
						<small class="pull-right">ONLINE {{usersOnlineCount}} / {{users.count}}</small>
					</h1>
				</div>
				{{#if users.count}}
					<table class="table table-striped table-bordered table-hover">
						<thead>
							<tr>
								<th>Место</th>
								<th>Никнейм</th>
								<th>Статус</th>
								<th>Команда</th>
								<th>Уровень</th>
								<th>Матчи</th>
								<th>Фраги</th>			
							</tr>
						</thead>
						<tbody>
							{{#each users}}
								{{>user_info}}
							{{/each}}
						</tbody>
					</table>
				{{else}}
					<div class="col-sm-12 center">
						<h1 class="text-muted">Пользователей нет</h1>
					</div>
				{{/if}}
			</div>
		{{else}}
			{{> noSteamID}}
		{{/if}}
	{{else}}
		{{#if loggingIn}}
			{{> loading}}
		{{else}}
			{{> unAuthorized}}
		{{/if}}
	{{/if}}
</template>

<template name="user_info">
	<tr>
		<td>
			{{#if profile.place}}
				{{profile.place}}
			{{/if}}
		</td>
		<td>
			<a href="/users/{{username}}">{{username}}</a>
		</td>
		<td>
			{{#if profile.online}}
				{{#if matchStatus username}}
					{{#if matchStatusInSearch username}}
						<a href="/matches/{{matchId username}}">
							<span class="label label-warning">В поиске</span>
						</a>
					{{else}}
						<a href="/matches/{{matchId username}}">
							<span class="label label-info">В игре</span>
						</a>
					{{/if}}
				{{else}}
					<span class="label label-success">Онлайн</span>
				{{/if}}
			{{else}}
				{{#if matchStatus username}}
					{{#if matchStatusInSearch username}}
						<a href="/matches/{{matchId username}}">
							<span class="label label-warning">В поиске</span>
						</a>
					{{else}}
						<a href="/matches/{{matchId username}}">
							<span class="label label-info">В игре</span>
						</a>
					{{/if}}
				{{else}}
					<span class="label label-primary">Офлайн</span>
				{{/if}}
			{{/if}}
		</td>
		<td>
			{{#if teamName username}}
				<a href="teams/{{teamName username}}">{{teamName username}}</a>
			{{else}}
				<span class="text-primary">Не в команде</span>
			{{/if}}
		</td>
		<td>
			{{#if profile.skill}}
				{{profile.skill}}
			{{else}}
				<span class="text-primary">Не определён</span>
			{{/if}}
		</td>
		<td>
			<span class="text-success" title="Число побед">{{profile.matchesWin}}</span> / <span title="Общее число игр">{{profile.matchesPlayed}}</span>
		</td>
		<td>
			<span class="text-success" title="Число убийств">{{profile.frags}}</span> / <span class="text-danger" title="Число смертей">{{profile.deaths}}</span>
		</td>
	</tr>
</template>